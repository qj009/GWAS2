hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
hap_plot <- hap_plot[which(hap_plot$P!=0),]
# pdf(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.pdf"), height=4, width=8)
# topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
# dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000)
topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07, get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000)
topr::manhattan(list(snp_plot, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
#
#     pdf(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.pdf"), height=4, width=8)
#     topr::manhattan(list(snp_plot, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
#     dev.off()
print(paste0("pheno ",T.Name," is done"))
}
output_path
paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv")
for(i in 1: length(T.Name.All)){
# select trait, get NA sample index, remove NA
T.Name <- T.Name.All[i]
print(paste0("pheno type is ",T.Name))
test="WALD"
input_path="data/UCR_maize/"
output_path="data/UCR_maize/"
other_ruls=""
# print("Ploting single manhattan plots................")
# post.plot(T.Name= T.Name, test=test,input_path=input_path, output_path=output_path, other_ruls=other_ruls)
#
print("Ploting manhattan plots together................")
snp <-read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
snp_plot <- snp[which(snp$P!=0),]
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% dplyr::select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hapi_plot <- hapi_plot[which(hapi_plot$P!=0),]
hap <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
hap_plot <- hap %>% dplyr::select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
hap_plot <- hap_plot[which(hap_plot$P!=0),]
# pdf(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.pdf"), height=4, width=8)
# topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
# dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000)
topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07, get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000)
topr::manhattan(list(snp_plot, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
#
#     pdf(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.pdf"), height=4, width=8)
#     topr::manhattan(list(snp_plot, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
#     dev.off()
print(paste0("pheno ",T.Name," is done"))
}
output_path
T.Name
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000)
topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07, get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000)
topr::manhattan(list(snp_plot, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
T.Name.All
T.Name.All <- colnames(pheno)[5:12]
for(i in 1: length(T.Name.All)){
# select trait, get NA sample index, remove NA
T.Name <- T.Name.All[i]
print(paste0("pheno type is ",T.Name))
test="WALD"
input_path="data/UCR_maize/"
output_path="data/UCR_maize/"
other_ruls=""
# print("Ploting single manhattan plots................")
# post.plot(T.Name= T.Name, test=test,input_path=input_path, output_path=output_path, other_ruls=other_ruls)
#
print("Ploting manhattan plots together................")
snp <-read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
snp_plot <- snp[which(snp$P!=0),]
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% dplyr::select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hapi_plot <- hapi_plot[which(hapi_plot$P!=0),]
hap <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
hap_plot <- hap %>% dplyr::select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
hap_plot <- hap_plot[which(hap_plot$P!=0),]
# pdf(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.pdf"), height=4, width=8)
# topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
# dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000);
topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07, get_chr_lengths_from_data = T,legend_name = "GWAS Type");
dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000);
topr::manhattan(list(snp_plot, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type");
dev.off()
#
#     pdf(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.pdf"), height=4, width=8)
#     topr::manhattan(list(snp_plot, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
#     dev.off()
print(paste0("pheno ",T.Name," is done"))
}
dev.off()
T.Name.All
for(i in 1: length(T.Name.All)){
# select trait, get NA sample index, remove NA
T.Name <- T.Name.All[i]
print(paste0("pheno type is ",T.Name))
test="WALD"
input_path="data/UCR_maize/"
output_path="data/UCR_maize/"
other_ruls=""
# print("Ploting single manhattan plots................")
# post.plot(T.Name= T.Name, test=test,input_path=input_path, output_path=output_path, other_ruls=other_ruls)
#
print("Ploting manhattan plots together................")
snp <-read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
snp_plot <- snp[which(snp$P!=0),]
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% dplyr::select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hapi_plot <- hapi_plot[which(hapi_plot$P!=0),]
hap <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
hap_plot <- hap %>% dplyr::select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
hap_plot <- hap_plot[which(hap_plot$P!=0),]
# pdf(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.pdf"), height=4, width=8)
# topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
# dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000);
topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07, get_chr_lengths_from_data = T,legend_name = "GWAS Type");
dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000);
topr::manhattan(list(snp_plot, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type");
dev.off()
#
#     pdf(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.pdf"), height=4, width=8)
#     topr::manhattan(list(snp_plot, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
#     dev.off()
print(paste0("pheno ",T.Name," is done"))
}
T.Name.All <- colnames(pheno)[5:12]
T.Name.All
i=1
T.Name <- T.Name.All[i]
print(paste0("pheno type is ",T.Name))
test="WALD"
input_path="data/UCR_maize/"
output_path="data/UCR_maize/"
other_ruls=""
snp <-read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
snp_plot <- snp[which(snp$P!=0),]
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% dplyr::select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hapi_plot <- hapi_plot[which(hapi_plot$P!=0),]
hap <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
hap_plot <- hap %>% dplyr::select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
hap_plot <- hap_plot[which(hap_plot$P!=0),]
# pdf(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.pdf"), height=4, width=8)
# topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
# dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000);
topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07, get_chr_lengths_from_data = T,legend_name = "GWAS Type");
dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000);
topr::manhattan(list(snp_plot, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type");
dev.off()
output_path
dev.off()
dev.off()
T.Name.All <- colnames(pheno)[4:12]
T.Name.All
i=1
T.Name <- T.Name.All[i]
print(paste0("pheno type is ",T.Name))
test="WALD"
input_path="data/UCR_maize/"
output_path="data/UCR_maize/"
other_ruls=""
# print("Ploting single manhattan plots................")
# post.plot(T.Name= T.Name, test=test,input_path=input_path, output_path=output_path, other_ruls=other_ruls)
#
print("Ploting manhattan plots together................")
snp <-read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
snp_plot <- snp[which(snp$P!=0),]
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% dplyr::select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hapi_plot <- hapi_plot[which(hapi_plot$P!=0),]
hap <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
hap_plot <- hap %>% dplyr::select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
hap_plot <- hap_plot[which(hap_plot$P!=0),]
# pdf(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.pdf"), height=4, width=8)
# topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
# dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000);
topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07, get_chr_lengths_from_data = T,legend_name = "GWAS Type");
dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000);
topr::manhattan(list(snp_plot, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type");
dev.off()
#
i=3
T.Name <- T.Name.All[i]
print(paste0("pheno type is ",T.Name))
test="WALD"
input_path="data/UCR_maize/"
output_path="data/UCR_maize/"
other_ruls=""
# print("Ploting single manhattan plots................")
# post.plot(T.Name= T.Name, test=test,input_path=input_path, output_path=output_path, other_ruls=other_ruls)
#
print("Ploting manhattan plots together................")
snp <-read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
snp_plot <- snp[which(snp$P!=0),]
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% dplyr::select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hapi_plot <- hapi_plot[which(hapi_plot$P!=0),]
hap <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
hap_plot <- hap %>% dplyr::select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
hap_plot <- hap_plot[which(hap_plot$P!=0),]
# pdf(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.pdf"), height=4, width=8)
# topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
# dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000);
topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07, get_chr_lengths_from_data = T,legend_name = "GWAS Type");
dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000);
topr::manhattan(list(snp_plot, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type");
dev.off()
T.Name
i
i=4
T.Name <- T.Name.All[i]
print(paste0("pheno type is ",T.Name))
test="WALD"
input_path="data/UCR_maize/"
output_path="data/UCR_maize/"
other_ruls=""
# print("Ploting single manhattan plots................")
# post.plot(T.Name= T.Name, test=test,input_path=input_path, output_path=output_path, other_ruls=other_ruls)
#
print("Ploting manhattan plots together................")
snp <-read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
snp_plot <- snp[which(snp$P!=0),]
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% dplyr::select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hapi_plot <- hapi_plot[which(hapi_plot$P!=0),]
hap <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
hap_plot <- hap %>% dplyr::select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
hap_plot <- hap_plot[which(hap_plot$P!=0),]
# pdf(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.pdf"), height=4, width=8)
# topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
# dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000);
topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07, get_chr_lengths_from_data = T,legend_name = "GWAS Type");
dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000);
topr::manhattan(list(snp_plot, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type");
dev.off()
#
length(T.Name.All)
i=5
T.Name <- T.Name.All[i]
print(paste0("pheno type is ",T.Name))
test="WALD"
input_path="data/UCR_maize/"
output_path="data/UCR_maize/"
other_ruls=""
# print("Ploting single manhattan plots................")
# post.plot(T.Name= T.Name, test=test,input_path=input_path, output_path=output_path, other_ruls=other_ruls)
#
print("Ploting manhattan plots together................")
snp <-read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
snp_plot <- snp[which(snp$P!=0),]
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% dplyr::select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hapi_plot <- hapi_plot[which(hapi_plot$P!=0),]
hap <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
hap_plot <- hap %>% dplyr::select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
hap_plot <- hap_plot[which(hap_plot$P!=0),]
# pdf(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.pdf"), height=4, width=8)
# topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
# dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000);
topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07, get_chr_lengths_from_data = T,legend_name = "GWAS Type");
dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000);
topr::manhattan(list(snp_plot, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type");
dev.off()
i
i=6
T.Name <- T.Name.All[i]
print(paste0("pheno type is ",T.Name))
test="WALD"
input_path="data/UCR_maize/"
output_path="data/UCR_maize/"
other_ruls=""
# print("Ploting single manhattan plots................")
# post.plot(T.Name= T.Name, test=test,input_path=input_path, output_path=output_path, other_ruls=other_ruls)
#
print("Ploting manhattan plots together................")
snp <-read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
snp_plot <- snp[which(snp$P!=0),]
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% dplyr::select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hapi_plot <- hapi_plot[which(hapi_plot$P!=0),]
hap <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
hap_plot <- hap %>% dplyr::select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
hap_plot <- hap_plot[which(hap_plot$P!=0),]
# pdf(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.pdf"), height=4, width=8)
# topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
# dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000);
topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07, get_chr_lengths_from_data = T,legend_name = "GWAS Type");
dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000);
topr::manhattan(list(snp_plot, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type");
dev.off()
#
#     pdf(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.pdf"), height=4, width=8)
#     topr::manhattan(list(snp_plot, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
#     dev.off()
i
=7
i=7
T.Name <- T.Name.All[i]
print(paste0("pheno type is ",T.Name))
test="WALD"
input_path="data/UCR_maize/"
output_path="data/UCR_maize/"
other_ruls=""
# print("Ploting single manhattan plots................")
# post.plot(T.Name= T.Name, test=test,input_path=input_path, output_path=output_path, other_ruls=other_ruls)
#
print("Ploting manhattan plots together................")
snp <-read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
snp_plot <- snp[which(snp$P!=0),]
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% dplyr::select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hapi_plot <- hapi_plot[which(hapi_plot$P!=0),]
hap <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
hap_plot <- hap %>% dplyr::select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
hap_plot <- hap_plot[which(hap_plot$P!=0),]
# pdf(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.pdf"), height=4, width=8)
# topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
# dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000);
topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07, get_chr_lengths_from_data = T,legend_name = "GWAS Type");
dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000);
topr::manhattan(list(snp_plot, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type");
dev.off()
#
i
i=8
T.Name <- T.Name.All[i]
print(paste0("pheno type is ",T.Name))
test="WALD"
input_path="data/UCR_maize/"
output_path="data/UCR_maize/"
other_ruls=""
# print("Ploting single manhattan plots................")
# post.plot(T.Name= T.Name, test=test,input_path=input_path, output_path=output_path, other_ruls=other_ruls)
#
print("Ploting manhattan plots together................")
snp <-read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
snp_plot <- snp[which(snp$P!=0),]
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% dplyr::select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hapi_plot <- hapi_plot[which(hapi_plot$P!=0),]
hap <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
hap_plot <- hap %>% dplyr::select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
hap_plot <- hap_plot[which(hap_plot$P!=0),]
# pdf(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.pdf"), height=4, width=8)
# topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
# dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000);
topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07, get_chr_lengths_from_data = T,legend_name = "GWAS Type");
dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000);
topr::manhattan(list(snp_plot, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type");
dev.off()
i=9
T.Name <- T.Name.All[i]
print(paste0("pheno type is ",T.Name))
test="WALD"
input_path="data/UCR_maize/"
output_path="data/UCR_maize/"
other_ruls=""
# print("Ploting single manhattan plots................")
# post.plot(T.Name= T.Name, test=test,input_path=input_path, output_path=output_path, other_ruls=other_ruls)
#
print("Ploting manhattan plots together................")
snp <-read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
snp_plot <- snp[which(snp$P!=0),]
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% dplyr::select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hapi_plot <- hapi_plot[which(hapi_plot$P!=0),]
hap <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
hap_plot <- hap %>% dplyr::select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
hap_plot <- hap_plot[which(hap_plot$P!=0),]
# pdf(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.pdf"), height=4, width=8)
# topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
# dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000);
topr::manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-07, get_chr_lengths_from_data = T,legend_name = "GWAS Type");
dev.off()
png(paste0(output_path,T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000);
topr::manhattan(list(snp_plot, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-07,get_chr_lengths_from_data = T,legend_name = "GWAS Type");
dev.off()
dir<-"/Users/zswx/Documents/UCR/Jialab/GWAS2"
setwd(dir)
gen<-read.csv(file="data/arabidopsis/call_method_32.b",header=T)
?mapvalues
??mapvalues
ClinVar <- read.table("ClinVar.txt")
setwd("/Users/zswx/Documents/UCR/Jialab/COH_Wang_bioinfo/Prime_Editing")
ClinVar <- read.table("ClinVar.txt")
View(ClinVar)
ClinVar <- read.table("ClinVar.txt", col.names = T)
View(ClinVar)
?read.table
ClinVar <- read.table("ClinVar.txt", header = TRUE)
View(ClinVar)
pad_and_concatenate <- function(num,leadc) {
formatted_num <- sprintf("%012d", num)  # Pad number with leading zeros
paste0(leadc, formatted_num)           # Concatenate "ABC" with formatted number
}
?apply
result <- apply(ClinVar, 1, pad_and_concatenate,leadc="VCV")
class(result)
length(result)
result
pad_and_concatenate <- function(num,leadc) {
formatted_num <- sprintf("%09d", num)  # Pad number with leading zeros
paste0(leadc, formatted_num)           # Concatenate "ABC" with formatted number
}
result <- apply(ClinVar, 1, pad_and_concatenate,leadc="VCV")
print(result)
ClinVar_full <- as.data.frame(cbind(ClinVar,"false"))
View(ClinVar_full)
ClinVar_full <- as.data.frame(cbind(result,"false"))
View(ClinVar_full)
?write.table
write.table(ClinVar_full, file= "ClinVar_full.txt",row.names = FALSE, col.names = FALSE, quote=FALSE,sep="\t")
