write_tsv(test.s.sub, paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_5e-05.tsv"),col_name=F)
#manhattan
png(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,".manhatten.png"), width=1400,height=800);
manhattan(test.s.map, chr="chr", bp="pos", p="p", snp="id", col=c("cyan","deepskyblue"),
suggestiveline=-log10(5e-05), genomewideline=-log10(5e-07),cex.axis = 2,cex.lab = 2, mgp=c(2, 0.5, 0));
dev.off()
#qq
png(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,".qq.png"),width=600, height=600);
qq(test.s.map$p,cex.axis = 2,cex.lab = 2, mgp=c(2, 0.5, 0));
dev.off()
#lambda
Ps.s = (test.s.map$p)
lambda.s <- median(qchisq(Ps.s,1,lower.tail=F), na.rm=TRUE )/ qchisq(0.5,1)
lambda.s
# }
#if(FALSE){
# hap initial result
#input
test.hapi <- read_tsv(paste0(input_path,T.Name,".F",test,".HAP.Initial",other_ruls,".tsv"),col_names=F)
test.hapi.map <- test.hapi %>% dplyr::select(X1,X4,X5,X8) %>% mutate(id = paste0("chr",X1,":",X4,"_",X5))
colnames(test.hapi.map) <- c("chr", "start","end","p","id")
test.hapi.sub <- test.hapi %>% filter(X8 <= 5e-05)
write_tsv(test.hapi.map, paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
write_tsv(test.hapi.sub, paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_5e-05.tsv"),col_name=F)
#manhattan
png(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,".manhatten.png"), width=1400,height=800);
manhattan(test.hapi.map, chr="chr", bp="start", p="p", snp="id", col=c("cyan","deepskyblue"),
suggestiveline=-log10(5e-05), genomewideline=-log10(5e-07),cex.axis = 2,cex.lab = 2, mgp=c(2, 0.5, 0));
dev.off()
#qq
png(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,".qq.png"),width=600, height=600);
qq(test.hapi.map$p,cex.axis = 2,cex.lab = 2, mgp=c(2, 0.5, 0));
dev.off()
#lambda.hi
Ps.hi = (test.hapi.map$p)
lambda.hi <- median(qchisq(Ps.hi,1,lower.tail=F), na.rm=TRUE )/ qchisq(0.5,1)
#haplotype result
#input
test.hap <- read_tsv(paste0(input_path,T.Name,".F",test,".HAP.FINAL",other_ruls,".tsv"),col_names=F)
test.hap.map <- test.hap  %>% dplyr::select(X1,X4,X5,X8) %>% mutate(id = paste0("chr",X1,":",X4,"_",X5))
colnames(test.hap.map) <- c("chr", "start","end","p","id")
test.hap.sub <- test.hap %>% filter(X8 <= 5e-05)
write_tsv(test.hap.map, paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
write_tsv(test.hap.sub, paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_5e-05.tsv"),col_name=F)
#manhattan
png(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,".manhatten.png"), width=1400,height=800);
manhattan(test.hap.map, chr="chr", bp="start", p="p", snp="id", col=c("cyan","deepskyblue"),
suggestiveline=-log10(5e-05), genomewideline=-log10(5e-07),cex.axis = 2,cex.lab = 2, mgp=c(2, 0.5, 0));
dev.off()
#qq
png(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,".qq.png"),width=600, height=600);
qq(test.hap.map$p,cex.axis = 2,cex.lab = 2, mgp=c(2, 0.5, 0));
dev.off()
#lambda.hap
Ps.hap = (test.hap.map$p)
lambda.hap <- median(qchisq(Ps.hap,1,lower.tail=F), na.rm=TRUE )/ qchisq(0.5,1)
#}
lambda <- c(lambda.s,lambda.hi,lambda.hap)
lambda <- c(lambda.hi,lambda.hap)
write.table(lambda,paste0(output_path,T.Name,".F",test,other_ruls,".lambda.txt"), col.names=F, sep="\t")
}
post.plot(T.Name= T.Name, test="WALD",input_path="data/arabidopsis/", output_path="data/arabidopsis/", other_ruls="")
library(qqman)
post.plot(T.Name= T.Name, test="WALD",input_path="data/arabidopsis/", output_path="data/arabidopsis/", other_ruls="")
post.plot(T.Name= T.Name, test="LRT",input_path="data/arabidopsis/", output_path="data/arabidopsis/", other_ruls="")
library(topr)
T.Name= T.Name
test="WALD"
input_path="data/arabidopsis/"
output_path="data/arabidopsis/"
other_ruls=""
snp <- paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv")
colnames(snp) <- c("CHROM","POS","P","ID")
snp <-read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% select(chr, end, p)
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% dplyr::select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hap <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
hap_plot <- hap %>% dplyr::select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
png(paste0("data/arabidopsis/",T.Name,".FWALD.SNP.HAPI.HAP_manhattan.pdf"), height=500, width=1000)
manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = 5e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
View(hap_plot)
View(hapi_plot)
version(topr)
?topr
install.packages("topr")
library(topr)
png(paste0("data/arabidopsis/",T.Name,".FWALD.SNP.HAPI.HAP_manhattan.pdf"), height=500, width=1000)
manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = 5e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
png(paste0("data/arabidopsis/",T.Name,".FWALD.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000)
manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = 5e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
test="LRT"
snp <- read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
library(MASS)
library(plyr)
library(dplyr)
library(tidyverse)
library(data.table)
library(ggpubr)
dir<-"/Users/zswx/Documents/UCR/Jialab/GWAS2"
setwd(dir)
test="LRT"
snp <- read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% dplyr::select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hap <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
hap_plot <- hap %>% dplyr::select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
png(paste0("data/arabidopsis/",T.Name,".FLRT.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000)
manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = 5e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
png(paste0("data/arabidopsis/",T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000)
manhattan(list(snp, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
png(paste0("data/arabidopsis/",T.Name,".FLRT.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000)
manhattan(list(snp, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
T.Name= T.Name
test="WALD"
input_path="data/arabidopsis/"
output_path="data/arabidopsis/"
other_ruls=""
# wald
snp <-read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% dplyr::select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hap <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
hap_plot <- hap %>% dplyr::select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
png(paste0("data/arabidopsis/",T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000)
manhattan(list(snp, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
P.threshold
P.Threshold
P.threshold <- 1/CN
P.threshold
RR.MULTI<-SEL.HAP(NULL, NULL, gen, YFIX, kin, 2, method, P.threshold, NULL, c(1,2),PAR=PAR)
WALD.HapInitial<-RR.MULTI[[2]][[1]]
LRT.HapInitial<-RR.MULTI[[2]][[2]]
Name.WALD.HapInitial<-paste0("data/arabidopsis/",T.Name,".FWALD.HAP.Initial.tsv")
write_tsv(as.data.frame(WALD.HapInitial),Name.WALD.HapInitial, col_names = F)
Name.LRT.HapInitial<-paste0("data/arabidopsis/",T.Name,".FLRT.HAP.Initial.tsv")
write_tsv(as.data.frame(LRT.HapInitial),Name.LRT.HapInitial, col_names = F)
WALD.FINAL<-RR.MULTI[[1]][[1]]
LRT.FINAL<-RR.MULTI[[1]][[2]]
Name.WALD.HAP<-paste0("data/arabidopsis/",T.Name,".FWALD.HAP.FINAL.tsv")
write_tsv(as.data.frame(WALD.FINAL),Name.WALD.HAP, col_names = F)
Name.LRT.HAP<-paste0("data/arabidopsis/",T.Name,".FLRT.HAP.FINAL.tsv")
write_tsv(as.data.frame(LRT.FINAL),Name.LRT.HAP, col_names = F)
library(qqman)
post.plot <- function(T.Name, test,other_ruls="",input_path, output_path){
options("scipen"=10)
#if(TRUE){
# SNP result
#input
test.s <- read_tsv(paste0(input_path,T.Name,".F",test,".SNP",other_ruls,".tsv"),col_names=F)
test.s.map <- test.s %>% dplyr::select(X1,X2,X5) %>% mutate(id = paste0("chr",X1,":",X2))
colnames(test.s.map) <- c("chr", "pos","p","id")
test.s.sub <- test.s %>% filter(X5 <= 5e-05)
write_tsv(test.s.map, paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
write_tsv(test.s.sub, paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_5e-05.tsv"),col_name=F)
#manhattan
png(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,".manhatten.png"), width=1400,height=800);
manhattan(test.s.map, chr="chr", bp="pos", p="p", snp="id", col=c("cyan","deepskyblue"),
suggestiveline=-log10(5e-05), genomewideline=-log10(5e-07),cex.axis = 2,cex.lab = 2, mgp=c(2, 0.5, 0));
dev.off()
#qq
png(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,".qq.png"),width=600, height=600);
qq(test.s.map$p,cex.axis = 2,cex.lab = 2, mgp=c(2, 0.5, 0));
dev.off()
#lambda
Ps.s = (test.s.map$p)
lambda.s <- median(qchisq(Ps.s,1,lower.tail=F), na.rm=TRUE )/ qchisq(0.5,1)
lambda.s
# }
#if(FALSE){
# hap initial result
#input
test.hapi <- read_tsv(paste0(input_path,T.Name,".F",test,".HAP.Initial",other_ruls,".tsv"),col_names=F)
test.hapi.map <- test.hapi %>% dplyr::select(X1,X4,X5,X8) %>% mutate(id = paste0("chr",X1,":",X4,"_",X5))
colnames(test.hapi.map) <- c("chr", "start","end","p","id")
test.hapi.sub <- test.hapi %>% filter(X8 <= 5e-05)
write_tsv(test.hapi.map, paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
write_tsv(test.hapi.sub, paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_5e-05.tsv"),col_name=F)
#manhattan
png(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,".manhatten.png"), width=1400,height=800);
manhattan(test.hapi.map, chr="chr", bp="start", p="p", snp="id", col=c("cyan","deepskyblue"),
suggestiveline=-log10(5e-05), genomewideline=-log10(5e-07),cex.axis = 2,cex.lab = 2, mgp=c(2, 0.5, 0));
dev.off()
#qq
png(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,".qq.png"),width=600, height=600);
qq(test.hapi.map$p,cex.axis = 2,cex.lab = 2, mgp=c(2, 0.5, 0));
dev.off()
#lambda.hi
Ps.hi = (test.hapi.map$p)
lambda.hi <- median(qchisq(Ps.hi,1,lower.tail=F), na.rm=TRUE )/ qchisq(0.5,1)
#haplotype result
#input
test.hap <- read_tsv(paste0(input_path,T.Name,".F",test,".HAP.FINAL",other_ruls,".tsv"),col_names=F)
test.hap.map <- test.hap  %>% dplyr::select(X1,X4,X5,X8) %>% mutate(id = paste0("chr",X1,":",X4,"_",X5))
colnames(test.hap.map) <- c("chr", "start","end","p","id")
test.hap.sub <- test.hap %>% filter(X8 <= 5e-05)
write_tsv(test.hap.map, paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
write_tsv(test.hap.sub, paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_5e-05.tsv"),col_name=F)
#manhattan
png(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,".manhatten.png"), width=1400,height=800);
manhattan(test.hap.map, chr="chr", bp="start", p="p", snp="id", col=c("cyan","deepskyblue"),
suggestiveline=-log10(5e-05), genomewideline=-log10(5e-07),cex.axis = 2,cex.lab = 2, mgp=c(2, 0.5, 0));
dev.off()
#qq
png(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,".qq.png"),width=600, height=600);
qq(test.hap.map$p,cex.axis = 2,cex.lab = 2, mgp=c(2, 0.5, 0));
dev.off()
#lambda.hap
Ps.hap = (test.hap.map$p)
lambda.hap <- median(qchisq(Ps.hap,1,lower.tail=F), na.rm=TRUE )/ qchisq(0.5,1)
#}
lambda <- c(lambda.s,lambda.hi,lambda.hap)
lambda <- c(lambda.hi,lambda.hap)
write.table(lambda,paste0(output_path,T.Name,".F",test,other_ruls,".lambda.txt"), col.names=F, sep="\t")
}
post.plot(T.Name= T.Name, test="WALD",input_path="data/arabidopsis/", output_path="data/arabidopsis/", other_ruls="")
post.plot(T.Name= T.Name, test="LRT",input_path="data/arabidopsis/", output_path="data/arabidopsis/", other_ruls="")
library(topr)
T.Name= T.Name
test="WALD"
input_path="data/arabidopsis/"
output_path="data/arabidopsis/"
other_ruls=""
snp <-read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% dplyr::select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hap <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
hap_plot <- hap %>% dplyr::select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
test
png(paste0("data/arabidopsis/",T.Name,".FWALD.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000)
manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = 5e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
library(topr)
png(paste0("data/arabidopsis/",T.Name,".FWALD.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000)
topr::manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = 5e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
dev.off()
png(paste0("data/arabidopsis/",T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000)
topr::manhattan(list(snp, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
png(paste0("data/arabidopsis/",T.Name,".FLRT.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000)
topr::manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = 5e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
png(paste0("data/arabidopsis/",T.Name,".FLRT.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000)
topr::manhattan(list(snp, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
test
pdf(paste0("data/arabidopsis/",T.Name,".FWALD.SNP.HAPI.HAP_manhattan.pdf"), height=4, width=8)
topr::manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
test="LRT"
snp <- read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% dplyr::select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hap <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
hap_plot <- hap %>% dplyr::select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
pdf(paste0("data/arabidopsis/",T.Name,".FLRT.SNP.HAPI.HAP_manhattan.pdf"), height=4, width=8)
topr::manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
png(paste0("data/arabidopsis/",T.Name,".FLRT.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000)
topr::manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = 5e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
png(paste0("data/arabidopsis/",T.Name,".FLRT.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000)
topr::manhattan(list(snp, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
P.Threshold
library(topr)
T.Name= T.Name
test="WALD"
input_path="data/arabidopsis/"
output_path="data/arabidopsis/"
other_ruls=""
# wald
snp <-read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% dplyr::select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hap <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
hap_plot <- hap %>% dplyr::select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
pdf(paste0("data/arabidopsis/",T.Name,".FWALD.SNP.HAPI.HAP_manhattan.pdf"), height=4, width=8)
topr::manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = P.Threshold,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
png(paste0("data/arabidopsis/",T.Name,".FWALD.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000)
topr::manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = P.Threshold,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
png(paste0("data/arabidopsis/",T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000)
topr::manhattan(list(snp, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = P.Threshold,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
# LRT
test="LRT"
snp <- read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% dplyr::select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hap <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
hap_plot <- hap %>% dplyr::select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
pdf(paste0("data/arabidopsis/",T.Name,".FLRT.SNP.HAPI.HAP_manhattan.pdf"), height=4, width=8)
topr::manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = P.Threshold,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
png(paste0("data/arabidopsis/",T.Name,".FLRT.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000)
topr::manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = P.Threshold,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
png(paste0("data/arabidopsis/",T.Name,".FLRT.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000)
topr::manhattan(list(snp, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = P.Threshold,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
options("scipen"=2)
library(topr)
T.Name= T.Name
test="WALD"
input_path="data/arabidopsis/"
output_path="data/arabidopsis/"
other_ruls=""
# wald
snp <-read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% dplyr::select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hap <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
hap_plot <- hap %>% dplyr::select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
pdf(paste0("data/arabidopsis/",T.Name,".FWALD.SNP.HAPI.HAP_manhattan.pdf"), height=4, width=8)
topr::manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = P.Threshold,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
png(paste0("data/arabidopsis/",T.Name,".FWALD.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000)
topr::manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = P.Threshold,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
png(paste0("data/arabidopsis/",T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000)
topr::manhattan(list(snp, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = P.Threshold,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
# LRT
test="LRT"
snp <- read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% dplyr::select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hap <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
hap_plot <- hap %>% dplyr::select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
pdf(paste0("data/arabidopsis/",T.Name,".FLRT.SNP.HAPI.HAP_manhattan.pdf"), height=4, width=8)
topr::manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = P.Threshold,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
png(paste0("data/arabidopsis/",T.Name,".FLRT.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000)
topr::manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = P.Threshold,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
png(paste0("data/arabidopsis/",T.Name,".FLRT.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000)
topr::manhattan(list(snp, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = P.Threshold,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
P.Threshold
library(topr)
T.Name= T.Name
test="WALD"
input_path="data/arabidopsis/"
output_path="data/arabidopsis/"
other_ruls=""
# wald
snp <-read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% dplyr::select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hap <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
hap_plot <- hap %>% dplyr::select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
pdf(paste0("data/arabidopsis/",T.Name,".FWALD.SNP.HAPI.HAP_manhattan.pdf"), height=4, width=8)
topr::manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 2.87e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
png(paste0("data/arabidopsis/",T.Name,".FWALD.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000)
topr::manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = 2.87e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
png(paste0("data/arabidopsis/",T.Name,".FWALD.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000)
topr::manhattan(list(snp, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 2.87e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
# LRT
test="LRT"
snp <- read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% dplyr::select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hap <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
hap_plot <- hap %>% dplyr::select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
pdf(paste0("data/arabidopsis/",T.Name,".FLRT.SNP.HAPI.HAP_manhattan.pdf"), height=4, width=8)
topr::manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 2.87e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
png(paste0("data/arabidopsis/",T.Name,".FLRT.SNP.HAPI.HAP_manhattan.png"), height=500, width=1000)
topr::manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = 2.87e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
png(paste0("data/arabidopsis/",T.Name,".FLRT.SNP.HAPI.HAP_manhattan_2.png"), height=500, width=1000)
topr::manhattan(list(snp, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 2.87e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
test="WALD"
snp <-read_tsv(paste0(output_path,T.Name,".F",test,".SNP",other_ruls,"_map.tsv"))
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
hapi <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.Initial",other_ruls,"_map.tsv"))
hapi_plot <- hapi %>% dplyr::select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hap <- read_tsv(paste0(output_path,T.Name,".F",test,".HAP.FINAL",other_ruls,"_map.tsv"))
hap_plot <- hap %>% dplyr::select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
pdf(paste0("data/arabidopsis/",T.Name,".FWALD.SNP.HAPI.HAP_manhattan.pdf"), height=4, width=8)
topr::manhattan(list(snp, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 2.87e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
load_all()
library(roxygen2)
library(devtools)
load_all()
Rp_dir <- paste0(dir,"/GWAS2")
?load_all
load_all(path=Rp_dir)
exists("SEL.HAP", where = globalenv(), inherits = FALSE)
check()
check(path=Rp_dir)
?check
check( pkg = "GWAS2")
use_package(c("MASS","plyr","dplyr","tidyverse","data.table","ggpubr"))
?use_package
use_package("MASS","plyr","dplyr","tidyverse","data.table","ggpubr","stats", "optim", "pchisq")
use_package("MASS","plyr","dplyr","tidyverse","data.table","ggpubr","stats", "optim", "pchisq")
use_package("MASS")
setwd(Rp_dir)
use_package("MASS","plyr","dplyr","tidyverse","data.table","ggpubr","stats", "optim", "pchisq")
use_package("MASS")
use_package("MASS","plyr")
use_package("plyr")
use_package("dplyr")
use_package("tidyverse")
use_package("tidyverse","depend")
use_package("ggpubr")
use_package("optim")
use_package("data.table")
use_package("stats")
use_package("pchisq")
use_package("optim","depend")
?use_mit_license
use_mit_license()
check()
use_dev_package("optim")
use_package("stats")
?pchisq
check()
check()
check()
importFrom("stats", "optim", "pchisq")
devtools::document()
warnings()
check()
？na.omit
?na.omit
