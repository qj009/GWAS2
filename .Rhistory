)
png(paste0(output_path_all,T.Name,".F",test,".SNP.HAPI.HAP",other_rules_hap,"_",sig_line,"_regional_chr4.png"), height=400, width=1000,res=300);
# pdf(paste0(output_path_all,T.Name,".F",test,".SNP.HAPI.HAP",other_rules_hap,"_",sig_line,"_regional_chr2_10kb.pdf"), height=2, width=5);
print(p2);
dev.off()
gene_plot_LD_region2
gene_plot_LD_region2 <- gene_plot_full %>% dplyr::filter(Species=="Arabidopsis" & Phenotype == "LD" & CHROM == 4) %>% arrange(START) %>% dplyr::filter(chr==4 & pos >= 15849711 & pos <= 15855462)
gene_plot_LD_region2 <- gene_plot_full %>% dplyr::filter(Species=="Arabidopsis" & Phenotype == "LD" & CHROM == 4) %>% arrange(START) %>% dplyr::filter(START >= 15849711 & END <= 15855462)
gene_plot_LD_region2
p1 <- p + geom_segment(data = gene_plot_LD_region2, aes(x = START, xend = END, y = ylim[2]-1.5, yend = ylim[2]-1.5), lineend = "square", linewidth= 1,alpha = 1,show.legend	=FALSE,color = "blue") +
geom_text(data = gene_plot_LD_region2, aes(x =START+1000, y = ylim[2]-0.5,label=GENE),color = "blue", size=2.5)
p2 <- p1 + theme(
plot.title = element_blank(),
axis.text.x = element_text(angle = 0, size = 15, vjust = 0.5),
axis.title.x = element_text(size=20),
axis.line.x = element_line(linewidth = 0.8),
axis.ticks.x = element_line(linewidth = 0.8),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
p2 <- p1 + theme(
plot.title = element_blank(),
axis.text.x = element_text(angle = 0, size = 8, vjust = 0.5),
axis.title.x = element_text(size=10),
axis.line.x = element_line(linewidth = 0.8),
axis.ticks.x = element_line(linewidth = 0.8),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
png(paste0(output_path_all,T.Name,".F",test,".SNP.HAPI.HAP",other_rules_hap,"_",sig_line,"_regional_chr4.png"), height=400, width=1000,res=300);
# pdf(paste0(output_path_all,T.Name,".F",test,".SNP.HAPI.HAP",other_rules_hap,"_",sig_line,"_regional_chr2_10kb.pdf"), height=2, width=5);
print(p2);
dev.off()
gene_plot_LD_region3 <- gene_plot_full %>% dplyr::filter(Species=="Arabidopsis" & Phenotype == "LD" & CHROM == 5) %>% arrange(START) %>% dplyr::filter(START >= 25415600 & END <= 25418635)
snp_file_LD_chr5_hap <- snp_file %>% dplyr::filter(chr==5 & pos >= 25415600 & pos <= 25418635)
hapi_file_LD_chr5_hap <- hapi_file %>% dplyr::filter(chr==5 & start >= 25415600 & end <= 25418635)
hap_file_LD_chr5_hap <- hap_file %>% dplyr::filter(chr==5 & start >= 25415600 & end <= 25418635)
ylim<-c(0,11)
p <- vis_regional(T.Name, snp_file_LD_chr5_hap, hapi_file_LD_chr5_hap, hap_file_LD_chr5_hap, sig_line=sig_line, ylim = ylim, xtitle = "Chromosome 5")
p1 <- p + geom_segment(data = gene_plot_LD_region3[1,], aes(x = START, xend = END, y = ylim[2]-2, yend = ylim[2]-2), lineend = "square", linewidth= 1,alpha = 1,show.legend	=FALSE,color = "blue") +
geom_segment(data = gene_plot_LD_region[2,], aes(x = START, xend = END, y = ylim[2]-1.5, yend = ylim[2]-1.5), lineend = "square", linewidth= 1,alpha = 1,show.legend	=FALSE,color = "blue") +
geom_text(data = gene_plot_LD_region3[1,], aes(x =START+500, y = ylim[2]-1,label=GENE),color = "blue") +
geom_text(data = gene_plot_LD_region3[2,], aes(x =START+500, y = ylim[2]-0.5,label=GENE),color = "blue")
p1 <- p + geom_segment(data = gene_plot_LD_region3[1,], aes(x = START, xend = END, y = ylim[2]-2, yend = ylim[2]-2), lineend = "square", linewidth= 1,alpha = 1,show.legend	=FALSE,color = "blue") +
geom_segment(data = gene_plot_LD_region3[2,], aes(x = START, xend = END, y = ylim[2]-1.5, yend = ylim[2]-1.5), lineend = "square", linewidth= 1,alpha = 1,show.legend	=FALSE,color = "blue") +
geom_text(data = gene_plot_LD_region3[1,], aes(x =START+500, y = ylim[2]-1,label=GENE),color = "blue") +
geom_text(data = gene_plot_LD_region3[2,], aes(x =START+500, y = ylim[2]-0.5,label=GENE),color = "blue")
p2 <- p1 + theme(
plot.title = element_blank(),
axis.text.x = element_text(angle = 0, size = 8, vjust = 0.5),
axis.title.x = element_text(size=10),
axis.line.x = element_line(linewidth = 0.8),
axis.ticks.x = element_line(linewidth = 0.8),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
png(paste0(output_path_all,T.Name,".F",test,".SNP.HAPI.HAP",other_rules_hap,"_",sig_line,"_regional_chr5.png"), height=400, width=1000,res=300);
print(p2);
dev.off()
p1 <- p + geom_segment(data = gene_plot_LD_region3[1,], aes(x = START, xend = END, y = ylim[2]-2, yend = ylim[2]-2), lineend = "square", linewidth= 1,alpha = 1,show.legend	=FALSE,color = "blue") +
geom_segment(data = gene_plot_LD_region3[2,], aes(x = START, xend = END, y = ylim[2]-1.5, yend = ylim[2]-1.5), lineend = "square", linewidth= 1,alpha = 1,show.legend	=FALSE,color = "blue") +
geom_text(data = gene_plot_LD_region3[1,], aes(x =START+500, y = ylim[2]-1,label=GENE),color = "blue", size=2.5) +
geom_text(data = gene_plot_LD_region3[2,], aes(x =START+500, y = ylim[2]-0.5,label=GENE),color = "blue",size=2.5)
p2 <- p1 + theme(
plot.title = element_blank(),
axis.text.x = element_text(angle = 0, size = 8, vjust = 0.5),
axis.title.x = element_text(size=10),
axis.line.x = element_line(linewidth = 0.8),
axis.ticks.x = element_line(linewidth = 0.8),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
png(paste0(output_path_all,T.Name,".F",test,".SNP.HAPI.HAP",other_rules_hap,"_",sig_line,"_regional_chr5.png"), height=400, width=1000,res=300);
print(p2);
dev.off()
test <- "WALD"
arab_pheno_name <- c("LD","LDV","SD","0W","2W","4W")
input_path_snp="data/arabidopsis/Six_phe/"
# output_path_snp="data/UCR_maize/original_Random_SNP_new/"
other_rules_snp="_new_log10_Random"
other_rules_snp_sigline="_log10_Random"
input_path_hap="data/arabidopsis/Six_phe/"
# output_path_hap="data/UCR_maize/original_Random/"
output_path_all="data/arabidopsis/Six_phe/"
other_rules_hap="_log10_Random_0.05"
ylim<-c(0,10)
i=3
T.Name <- arab_pheno_name[i]
sig_info <- read.table(paste0(input_path_snp,T.Name,".FCN_P.SNP",other_rules_snp_sigline,".txt"), header = FALSE, sep="\t")
sig_info
sig_line <- as.numeric(sig_info[2,2])
print(paste0("significant line is ", sig_line))
snp_file = paste0(input_path_snp,T.Name,".F",test,".SNP",other_rules_snp,"_map.tsv")
hapi_file = paste0(input_path_hap,T.Name,".F",test,".HAP.Initial",other_rules_hap,"_map.tsv")
hap_file = paste0(input_path_hap,T.Name,".F",test,".HAP.FINAL",other_rules_hap,"_map.tsv")
snp_file <- read_tsv(snp_file)
hapi_file <- read_tsv(hapi_file)
hap_file <- read_tsv(hap_file)
hap_file <- hap_file %>% dplyr::filter(Hap_length>=3)%>% dplyr::select(-Hap_length)
gene_plot_full <- read_tsv("data/gene_hap_only.txt")
p <- vis_regional(T.Name, snp_file_SD_chr3_hap, hapi_file_SD_chr3_hap, hap_file_SD_chr3_hap, sig_line=sig_line, ylim = ylim, xtitle = "Chromosome 3")
p2 <- p1 + theme(
plot.title = element_blank(),
axis.text.x = element_text(angle = 0, size = 8, vjust = 0.5),
axis.title.x = element_text(size=10),
axis.line.x = element_line(linewidth = 0.8),
axis.ticks.x = element_line(linewidth = 0.8),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
snp_file_SD_chr3_hap <- snp_file %>% dplyr::filter(chr==3 & pos >= 18922304 & pos <= 18932181)
hapi_file_SD_chr3_hap <- hapi_file %>% dplyr::filter(chr==3 & start >= 18922304 & end <= 18932181)
hap_file_SD_chr3_hap <- hap_file %>% dplyr::filter(chr==3 & start >= 18922304 & end <= 18932181)
gene_plot_SD_region1 <- gene_plot_full %>% dplyr::filter(Species=="Arabidopsis" & Phenotype == T.Name & CHROM == 3) %>% arrange(START)
p <- vis_regional(T.Name, snp_file_SD_chr3_hap, hapi_file_SD_chr3_hap, hap_file_SD_chr3_hap, sig_line=sig_line, ylim = ylim, xtitle = "Chromosome 3")
p1 <- p + geom_segment(data = gene_plot_SD_region1, aes(x = START, xend = END, y = ylim[2]-1.5, yend = ylim[2]-1.5), lineend = "square", linewidth= 1,alpha = 1,show.legend	=FALSE,color = "blue") +
geom_text(data = gene_plot_SD_region1, aes(x =START+500, y = ylim[2]-0.5,label=GENE),color = "blue") +
scale_x_continuous(labels = c("18925000","18930000"),breaks = c(18925000,18930000))
p2 <- p1 + theme(
plot.title = element_blank(),
axis.text.x = element_text(angle = 0, size = 8, vjust = 0.5),
axis.title.x = element_text(size=10),
axis.line.x = element_line(linewidth = 0.8),
axis.ticks.x = element_line(linewidth = 0.8),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
T.Name
pdf(paste0(output_path_all,T.Name,".F",test,".SNP.HAPI.HAP",other_rules_hap,"_",sig_line,"_regional_chr3_left_right.pdf"), height=2, width=5);
print(p2);
dev.off()
png(paste0(output_path_all,T.Name,".F",test,".SNP.HAPI.HAP",other_rules_hap,"_",sig_line,"regional_chr3_left_right.png"), height=400, width=1000,res=300);
print(p2);
dev.off()
p1 <- p + geom_segment(data = gene_plot_SD_region1, aes(x = START, xend = END, y = ylim[2]-1.5, yend = ylim[2]-1.5), lineend = "square", linewidth= 1,alpha = 1,show.legend	=FALSE,color = "blue") +
geom_text(data = gene_plot_SD_region1, aes(x =START+500, y = ylim[2]-0.5,label=GENE),color = "blue",size=2.5) +
scale_x_continuous(labels = c("18925000","18930000"),breaks = c(18925000,18930000))
p2 <- p1 + theme(
plot.title = element_blank(),
axis.text.x = element_text(angle = 0, size = 8, vjust = 0.5),
axis.title.x = element_text(size=10),
axis.line.x = element_line(linewidth = 0.8),
axis.ticks.x = element_line(linewidth = 0.8),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
png(paste0(output_path_all,T.Name,".F",test,".SNP.HAPI.HAP",other_rules_hap,"_",sig_line,"regional_chr3_left_right.png"), height=400, width=1000,res=300);
print(p2);
dev.off()
gene_plot_SD_region2 <- gene_plot_full %>% dplyr::filter(Species=="Arabidopsis" & Phenotype == T.Name & CHROM == 4) %>% arrange(START)
snp_file_SD_chr4_hap <- snp_file %>% dplyr::filter(chr==4 & pos >= 8864615 & pos <= 8872026)
hapi_file_SD_chr4_hap <- hapi_file %>% dplyr::filter(chr==4 & start >= 8864615 & end <= 8872026)
hap_file_SD_chr4_hap <- hap_file %>% dplyr::filter(chr==4 & start >= 8864615 & end <= 8872026)
p <- vis_regional(T.Name, snp_file_SD_chr4_hap, hapi_file_SD_chr4_hap, hap_file_SD_chr4_hap, sig_line=sig_line, ylim = ylim, xtitle = "Chromosome 4")
p1 <- p + geom_segment(data = gene_plot_SD_region2, aes(x = START, xend = END, y = ylim[2]-1.5, yend = ylim[2]-1.5), lineend = "square", linewidth= 1,alpha = 1,show.legend	=FALSE,color = "blue") +
geom_text(data = gene_plot_SD_region2, aes(x =START+1000, y = ylim[2]-0.5,label=GENE),color = "blue", size=2.5)  +
scale_x_continuous(labels = c("8866000","8870000"),breaks = c(8866000,8870000))
p2 <- p1 + theme(
plot.title = element_blank(),
axis.text.x = element_text(angle = 0, size = 8, vjust = 0.5),
axis.title.x = element_text(size=10),
axis.line.x = element_line(linewidth = 0.8),
axis.ticks.x = element_line(linewidth = 0.8),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
png(paste0(output_path_all,T.Name,".F",test,".SNP.HAPI.HAP",other_rules_hap,"_",sig_line,"regional_chr4.png"), height=400, width=1000,res=300);
print(p2);
dev.off()
gene_plot_4W_region2 <- gene_plot_full %>% dplyr::filter(Species=="Arabidopsis" & Phenotype == T.Name & CHROM == 5) %>% arrange(START)
snp_file_4W_chr5_hap <- snp_file %>% dplyr::filter(chr==5 & pos >= 13922418 & pos <= 13931885)
hapi_file_4W_chr5_hap <- hapi_file %>% dplyr::filter(chr==5 & start >= 13922418 & end <= 13931885)
hap_file_4W_chr5_hap <- hap_file %>% dplyr::filter(chr==5 & start >= 13922418 & end <= 13931885)
p <- vis_regional(T.Name, snp_file_4W_chr5_hap, hapi_file_4W_chr5_hap, hap_file_4W_chr5_hap, sig_line=sig_line, ylim = ylim, xtitle = "Chromosome 5")
p1 <- p + geom_segment(data = gene_plot_4W_region2, aes(x = START, xend = END, y = ylim[2]-1.5, yend = ylim[2]-1.5), lineend = "square", linewidth= 1,alpha = 1,show.legend	=FALSE,color = "blue") +
geom_text(data = gene_plot_4W_region2, aes(x =START+1000, y = ylim[2]-0.5,label=GENE),color = "blue", size=2.5)  +
scale_x_continuous(labels = c("13925000","13927500","13930000"),breaks = c(13925000,13927500,13930000))
i=6
T.Name <- arab_pheno_name[i]
sig_info <- read.table(paste0(input_path_snp,T.Name,".FCN_P.SNP",other_rules_snp_sigline,".txt"), header = FALSE, sep="\t")
sig_info
sig_line <- as.numeric(sig_info[2,2])
print(paste0("significant line is ", sig_line))
snp_file = paste0(input_path_snp,T.Name,".F",test,".SNP",other_rules_snp,"_map.tsv")
hapi_file = paste0(input_path_hap,T.Name,".F",test,".HAP.Initial",other_rules_hap,"_map.tsv")
hap_file = paste0(input_path_hap,T.Name,".F",test,".HAP.FINAL",other_rules_hap,"_map.tsv")
snp_file <- read_tsv(snp_file)
hapi_file <- read_tsv(hapi_file)
hap_file <- read_tsv(hap_file)
hap_file <- hap_file %>% dplyr::filter(Hap_length>=3)%>% dplyr::select(-Hap_length)
gene_plot_full <- read_tsv("data/gene_hap_only.txt")
snp_file_4W_chr5_1 <- snp_file %>% dplyr::filter(chr==5 & pos >= 13915000 & pos <= 13935000)
hapi_file_4W_chr5_1 <- hapi_file %>% dplyr::filter(chr==5 & start >= 13915000 & end <= 13935000)
hap_file_4W_chr5_1 <- hap_file %>% dplyr::filter(chr==5 & start >= 13915000 & end <= 13935000)
p <- vis_regional(T.Name, snp_file_4W_chr5_1, hapi_file_4W_chr5_1, hap_file_4W_chr5_1, sig_line=sig_line, ylim = ylim, xtitle = "Chromosome 5")
gene_plot_4W_region1 <- gene_plot_full %>% dplyr::filter(Species=="Arabidopsis" & Phenotype == T.Name & CHROM == 2) %>% arrange(START)
snp_file_4W_chr2_hap <- snp_file %>% dplyr::filter(chr==2 & pos >= 13863635 & pos <= 13872246)
hapi_file_4W_chr2_hap <- hapi_file %>% dplyr::filter(chr==2 & start >= 13863635 & end <= 13872246)
hap_file_4W_chr2_hap <- hap_file %>% dplyr::filter(chr==2 & start >= 13863635 & end <= 13872246)
p <- vis_regional(T.Name, snp_file_4W_chr2_hap, hapi_file_4W_chr2_hap, hap_file_4W_chr2_hap, sig_line=sig_line, ylim = ylim, xtitle = "Chromosome 2")
p1 <- p + geom_segment(data = gene_plot_4W_region1, aes(x = START, xend = END, y = ylim[2]-1.5, yend = ylim[2]-1.5), lineend = "square", linewidth= 1,alpha = 1,show.legend	=FALSE,color = "blue") +
geom_text(data = gene_plot_4W_region1, aes(x =START+500, y = ylim[2]-0.5,label=GENE),color = "blue", size=2.5) +
scale_x_continuous(labels = c("13865000","13867500","13870000"),breaks = c(13865000,13867500,13870000))
p2 <- p1 + theme(
plot.title = element_blank(),
axis.text.x = element_text(angle = 0, size = 8, vjust = 0.5),
axis.title.x = element_text(size=10),
axis.line.x = element_line(linewidth = 0.8),
axis.ticks.x = element_line(linewidth = 0.8),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
png(paste0(output_path_all,T.Name,".F",test,".SNP.HAPI.HAP",other_rules_hap,"_",sig_line,"regional_chr2.png"), height=400, width=1000,res=300);
print(p2);
dev.off()
gene_plot_4W_region2 <- gene_plot_full %>% dplyr::filter(Species=="Arabidopsis" & Phenotype == T.Name & CHROM == 5) %>% arrange(START)
snp_file_4W_chr5_hap <- snp_file %>% dplyr::filter(chr==5 & pos >= 13922418 & pos <= 13931885)
hapi_file_4W_chr5_hap <- hapi_file %>% dplyr::filter(chr==5 & start >= 13922418 & end <= 13931885)
hap_file_4W_chr5_hap <- hap_file %>% dplyr::filter(chr==5 & start >= 13922418 & end <= 13931885)
p <- vis_regional(T.Name, snp_file_4W_chr5_hap, hapi_file_4W_chr5_hap, hap_file_4W_chr5_hap, sig_line=sig_line, ylim = ylim, xtitle = "Chromosome 5")
p1 <- p + geom_segment(data = gene_plot_4W_region2, aes(x = START, xend = END, y = ylim[2]-1.5, yend = ylim[2]-1.5), lineend = "square", linewidth= 1,alpha = 1,show.legend	=FALSE,color = "blue") +
geom_text(data = gene_plot_4W_region2, aes(x =START+1000, y = ylim[2]-0.5,label=GENE),color = "blue", size=2.5)  +
scale_x_continuous(labels = c("13925000","13927500","13930000"),breaks = c(13925000,13927500,13930000))
p2 <- p1 + theme(
plot.title = element_blank(),
axis.text.x = element_text(angle = 0, size = 8, vjust = 0.5),
axis.title.x = element_text(size=10),
axis.line.x = element_line(linewidth = 0.8),
axis.ticks.x = element_line(linewidth = 0.8),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
png(paste0(output_path_all,T.Name,".F",test,".SNP.HAPI.HAP",other_rules_hap,"_",sig_line,"regional_chr5.png"), height=400, width=1000,res=300);
print(p2);
dev.off()
maize_pheno <- read_tsv("data/UCR_maize/phe_original_complete.txt")
maize_pheno_name <- colnames(maize_pheno)[4:12]
test <- "WALD"
input_path_snp="data/UCR_maize/original_Random_SNP_new/"
# output_path_snp="data/UCR_maize/original_Random_SNP_new/"
other_rules_snp="_original_Random_new"
input_path_hap="data/UCR_maize/original_Random_HAP_0.05/"
# output_path_hap="data/UCR_maize/original_Random/"
output_path_all="data/UCR_maize/original_Random_newSNP_hap/"
other_rules_hap="_original_Random_0.05"
# other_rules_hap = "_Random_notrans_0.05"
# other_rules_hap = "_Random_notrans_0.005"
sig_line <- 1.29e-06
ylim<-c(0,9)
i=3
T.Name <- maize_pheno_name[i]
snp_file = paste0(input_path_snp,T.Name,".F",test,".SNP",other_rules_snp,"_map.tsv")
hapi_file = paste0(input_path_hap,T.Name,".F",test,".HAP.Initial",other_rules_hap,"_map.tsv")
hap_file = paste0(input_path_hap,T.Name,".F",test,".HAP.FINAL",other_rules_hap,"_map.tsv")
snp_file <- read_tsv(snp_file)
hapi_file <- read_tsv(hapi_file)
hap_file <- read_tsv(hap_file)
hap_file <- hap_file %>% dplyr::filter(Hap_length>=3)%>% dplyr::select(-Hap_length)
gene_plot_ERN_region1 <- gene_plot_full %>% dplyr::filter(Species=="Maize" & Phenotype == T.Name & CHROM == 2) %>% arrange(START)
snp_file_ERN_chr2_hap <- snp_file %>% dplyr::filter(chr==2 & pos >= 142998000 & pos <= 143010000)
hapi_file_ERN_chr2_hap <- hapi_file %>% dplyr::filter(chr==2 & start >= 142998000 & end <= 143010000)
hap_file_ERN_chr2_hap <- hap_file %>% dplyr::filter(chr==2 & start >= 142998000 & end <= 143010000)
p <- vis_regional(T.Name, snp_file_ERN_chr2_hap, hapi_file_ERN_chr2_hap, hap_file_ERN_chr2_hap, sig_line=sig_line, ylim = ylim, xtitle = "Chromosome 2")
output_path_all
p1 <- p + geom_segment(data = gene_plot_ERN_region1, aes(x = START, xend = END, y = ylim[2]-1.5, yend = ylim[2]-1.5), lineend = "square", linewidth= 1,alpha = 1,show.legend	=FALSE,color = "blue") +
geom_text(data = gene_plot_ERN_region1, aes(x =START+2000, y = ylim[2]-0.5,label=GENE),color = "blue", size=2.5) +
scale_x_continuous(labels = c("143001000","143007000"),breaks = c(143001000,143007000))
p2 <- p1 + theme(
plot.title = element_blank(),
axis.text.x = element_text(angle = 0, size = 8, vjust = 0.5),
axis.title.x = element_text(size=10),
axis.line.x = element_line(linewidth = 0.8),
axis.ticks.x = element_line(linewidth = 0.8),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
png(paste0(output_path_all,T.Name,".F",test,".SNP.HAPI.HAP",other_rules_hap,"_",sig_line,"regional_chr2.png"), height=400, width=1000,res=300);
print(p2);
dev.off()
gene_plot_ERN_region2 <- gene_plot_full %>% dplyr::filter(Species=="Maize" & Phenotype == "ERN" & CHROM == 8) %>% arrange(START)
snp_file_ERN_chr8_hap <- snp_file %>% dplyr::filter(chr==8 & pos >= 101390373 & pos <= 101466105)
hapi_file_ERN_chr8_hap <- hapi_file %>% dplyr::filter(chr==8 & start >= 101390373 & end <= 101466105)
hap_file_ERN_chr8_hap <- hap_file %>% dplyr::filter(chr==8 & start >= 101390373 & end <= 101466105)
p <- vis_regional(T.Name, snp_file_ERN_chr8_hap, hapi_file_ERN_chr8_hap, hap_file_ERN_chr8_hap, sig_line=sig_line, ylim = ylim, xtitle = "Chromosome 8")
p1 <- p + geom_segment(data = gene_plot_ERN_region2, aes(x = START, xend = END, y = ylim[2]-1.5, yend = ylim[2]-1.5), lineend = "square", linewidth= 1,alpha = 1,show.legend	=FALSE,color = "blue") +
geom_text(data = gene_plot_ERN_region2, aes(x =START+1000, y = ylim[2]-0.5,label=GENE),color = "blue", size=2.5) +
scale_x_continuous(labels = c("101410000","101450000"),breaks = c(101410000,101450000))
p2 <- p1 + theme(
plot.title = element_blank(),
axis.text.x = element_text(angle = 0, size = 8, vjust = 0.5),
axis.title.x = element_text(size=10),
axis.line.x = element_line(linewidth = 0.8),
axis.ticks.x = element_line(linewidth = 0.8),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
png(paste0(output_path_all,T.Name,".F",test,".SNP.HAPI.HAP",other_rules_hap,"_",sig_line,"regional_chr8.png"), height=400, width=1000,res=300);
print(p2);
dev.off()
i=4
T.Name <- maize_pheno_name[i]
snp_file = paste0(input_path_snp,T.Name,".F",test,".SNP",other_rules_snp,"_map.tsv")
hapi_file = paste0(input_path_hap,T.Name,".F",test,".HAP.Initial",other_rules_hap,"_map.tsv")
hap_file = paste0(input_path_hap,T.Name,".F",test,".HAP.FINAL",other_rules_hap,"_map.tsv")
snp_file <- read_tsv(snp_file)
hapi_file <- read_tsv(hapi_file)
hap_file <- read_tsv(hap_file)
hap_file <- hap_file %>% dplyr::filter(Hap_length>=3)%>% dplyr::select(-Hap_length)
T.Name
gene_plot_KNR_region1 <- gene_plot_full %>% dplyr::filter(Species=="Maize" & Phenotype == T.Name & CHROM == 2) %>% arrange(START)
snp_file_KNR_chr2_hap <- snp_file %>% dplyr::filter(chr==2 & pos >= 142998000 & pos <= 143031000)
hapi_file_KNR_chr2_hap <- hapi_file %>% dplyr::filter(chr==2 & start >= 142998000 & end <= 143031000)
hap_file_KNR_chr2_hap <- hap_file %>% dplyr::filter(chr==2 & start >= 142998000 & end <= 143031000)
p <- vis_regional(T.Name, snp_file_KNR_chr2_hap, hapi_file_KNR_chr2_hap, hap_file_KNR_chr2_hap, sig_line=sig_line, ylim = ylim, xtitle = "Chromosome 2")
p1 <- p + geom_segment(data = gene_plot_KNR_region1, aes(x = START, xend = END, y = ylim[2]-1.5, yend = ylim[2]-1.5), lineend = "square", linewidth= 1,alpha = 1,show.legend	=FALSE,color = "blue") +
geom_text(data = gene_plot_KNR_region1, aes(x =START+3500, y = ylim[2]-0.5,label=GENE),color = "blue", size=2.5) +
scale_x_continuous(labels = c("143010000","143020000"),breaks = c(143010000,143020000))
# png output
p2 <- p1 + theme(
plot.title = element_blank(),
axis.text.x = element_text(angle = 0, size = 8, vjust = 0.5),
axis.title.x = element_text(size=10),
axis.line.x = element_line(linewidth = 0.8),
axis.ticks.x = element_line(linewidth = 0.8),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
png(paste0(output_path_all,T.Name,".F",test,".SNP.HAPI.HAP",other_rules_hap,"_",sig_line,"_regional_chr2.png"), height=400, width=1000,res=300);
print(p2);
dev.off()
gene_plot_KNR_region2 <- gene_plot_full %>% dplyr::filter(Species=="Maize" & Phenotype == T.Name & CHROM == 5) %>% arrange(START)
snp_file_KNR_chr5_hap <- snp_file %>% dplyr::filter(chr==5 & pos >= 186646000 & pos <= 186814000)
hapi_file_KNR_chr5_hap <- hapi_file %>% dplyr::filter(chr==5 & start >= 186646000 & end <= 186814000)
hap_file_KNR_chr5_hap <- hap_file %>% dplyr::filter(chr==5 & start >= 186646000 & end <= 186814000)
p <- vis_regional(T.Name, snp_file_KNR_chr5_hap, hapi_file_KNR_chr5_hap, hap_file_KNR_chr5_hap, sig_line=sig_line, ylim = ylim, xtitle = "Chromosome 5")
p1 <- p + geom_segment(data = gene_plot_KNR_region2, aes(x = START, xend = END, y = ylim[2]-1.5, yend = ylim[2]-1.5), lineend = "square", linewidth= 1,alpha = 1,show.legend	=FALSE,color = "blue") +
geom_text(data = gene_plot_KNR_region2, aes(x =START+3000, y = ylim[2]-0.5,label=GENE),color = "blue", size=2.5) +
scale_x_continuous(labels = c("186700000","186800000"),breaks = c(186700000,186800000))
p2 <- p1 + theme(
plot.title = element_blank(),
axis.text.x = element_text(angle = 0, size = 8, vjust = 0.5),
axis.title.x = element_text(size=10),
axis.line.x = element_line(linewidth = 0.8),
axis.ticks.x = element_line(linewidth = 0.8),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
png(paste0(output_path_all,T.Name,".F",test,".SNP.HAPI.HAP",other_rules_hap,"_",sig_line,"_regional_chr5.png"), height=400, width=1000,res=300);
print(p2);
dev.off()
rice_pheno <- read_tsv("data/ZhiwuZhang/Hybrid_phenotype.txt")
rice_pheno_name <- colnames(rice_pheno)[4:15]
# T.Name <- "PC"
test <- "WALD"
input_path_snp="data/ZhiwuZhang/"
# output_path_snp="data/UCR_maize/original_Random_SNP_new/"
other_rules_snp="_new_notrans"
input_path_hap="data/ZhiwuZhang/"
# output_path_hap="data/UCR_maize/original_Random/"
output_path_all="data/ZhiwuZhang/"
other_rules_hap="_Random_notrans_0.05"
T.Name <- rice_pheno_name[i]
snp_file = paste0(input_path_snp,T.Name,".F",test,".SNP",other_rules_snp,"_map.tsv")
hapi_file = paste0(input_path_hap,T.Name,".F",test,".HAP.Initial",other_rules_hap,"_map.tsv")
hap_file = paste0(input_path_hap,T.Name,".F",test,".HAP.FINAL",other_rules_hap,"_map.tsv")
snp_file <- read_tsv(snp_file)
hapi_file <- read_tsv(hapi_file)
hap_file <- read_tsv(hap_file)
hap_file <- hap_file %>% dplyr::filter(Hap_length>=3)%>% dplyr::select(-Hap_length)
gene_plot_CD_region1 <- gene_plot_full %>% dplyr::filter(Species=="Rice" & Phenotype == T.Name & CHROM == 3) %>% arrange(START)
snp_file_CD_chr3_hap <- snp_file %>% dplyr::filter(chr==3 & pos >= 35251336 & pos <= 35255136)
hapi_file_CD_chr3_hap <- hapi_file %>% dplyr::filter(chr==3 & start >= 35251336 & end <= 35255136)
hap_file_CD_chr3_hap <- hap_file %>% dplyr::filter(chr==3 & start >= 35251336 & end <= 35255136)
p <- vis_regional(T.Name, snp_file_CD_chr3_hap, hapi_file_CD_chr3_hap, hap_file_CD_chr3_hap, sig_line=sig_line, ylim = ylim, xtitle = "Chromosome 3")
p1 <- p + geom_segment(data = gene_plot_CD_region1, aes(x = START, xend = END, y = ylim[2]-1.5, yend = ylim[2]-1.5), lineend = "square", linewidth= 1,alpha = 1,show.legend	=FALSE,color = "blue") +
geom_text(data = gene_plot_CD_region1, aes(x =START+500, y = ylim[2]-0.5,label=GENE),color = "blue", size=2.5)
p2 <- p1 + theme(
plot.title = element_blank(),
axis.text.x = element_text(angle = 0, size = 8, vjust = 0.5),
axis.title.x = element_text(size=10),
axis.line.x = element_line(linewidth = 0.8),
axis.ticks.x = element_line(linewidth = 0.8),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
png(paste0(output_path_all,T.Name,".F",test,".SNP.HAPI.HAP",other_rules_hap,"_",sig_line,"_regional_chr3.png"), height=400, width=1000,res=300);
print(p2);
dev.off()
sig_line <- 4.1e-07
ylim<-c(0,12)
i=11
T.Name <- rice_pheno_name[i]
snp_file = paste0(input_path_snp,T.Name,".F",test,".SNP",other_rules_snp,"_map.tsv")
hapi_file = paste0(input_path_hap,T.Name,".F",test,".HAP.Initial",other_rules_hap,"_map.tsv")
hap_file = paste0(input_path_hap,T.Name,".F",test,".HAP.FINAL",other_rules_hap,"_map.tsv")
snp_file <- read_tsv(snp_file)
hapi_file <- read_tsv(hapi_file)
hap_file <- read_tsv(hap_file)
hap_file <- hap_file %>% dplyr::filter(Hap_length>=3)%>% dplyr::select(-Hap_length)
# region
gene_plot_MRR_region1 <- gene_plot_full %>% dplyr::filter(Species=="Rice" & Phenotype == T.Name & CHROM == 3) %>% arrange(START)
snp_file_MRR_chr3_hap <- snp_file %>% dplyr::filter(chr==3 & pos >= 22568000 & pos <= 22574000)
hapi_file_MRR_chr3_hap <- hapi_file %>% dplyr::filter(chr==3 & start >= 22568000 & end <= 22574000)
hap_file_MRR_chr3_hap <- hap_file %>% dplyr::filter(chr==3 & start >= 22568000 & end <= 22574000)
p <- vis_regional(T.Name, snp_file_MRR_chr3_hap, hapi_file_MRR_chr3_hap, hap_file_MRR_chr3_hap, sig_line=sig_line, ylim = ylim, xtitle = "Chromosome 3")
p1 <- p + geom_segment(data = gene_plot_MRR_region1[1,], aes(x = START, xend = END, y = ylim[2]-4, yend = ylim[2]-4), lineend = "square", linewidth= 1,alpha = 1,show.legend	=FALSE,color = "blue") +
geom_segment(data = gene_plot_MRR_region1[2,], aes(x = START, xend = END, y = ylim[2]-1.5, yend = ylim[2]-1.5), lineend = "square", linewidth= 1,alpha = 1,show.legend	=FALSE,color = "blue") +
geom_text(data = gene_plot_MRR_region1[1,], aes(x =START+500, y = ylim[2]-3,label=GENE),color = "blue", size=2.5) +
geom_text(data = gene_plot_MRR_region1[2,], aes(x =START+500, y = ylim[2]-0.5,label=GENE),color = "blue", size=2.5) +
scale_x_continuous(labels = c("22570000","22572000"),breaks = c(22570000,22572000))
p2 <- p1 + theme(
plot.title = element_blank(),
axis.text.x = element_text(angle = 0, size = 8, vjust = 0.5),
axis.title.x = element_text(size=10),
axis.line.x = element_line(linewidth = 0.8),
axis.ticks.x = element_line(linewidth = 0.8),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
png(paste0(output_path_all,T.Name,".F",test,".SNP.HAPI.HAP",other_rules_hap,"_",sig_line,"_regional_chr3.png"), height=400, width=1000,res=300);
print(p2);
dev.off()
ylim<-c(0,10)
gene_plot_MRR_region2 <- gene_plot_full %>% dplyr::filter(Species=="Rice" & Phenotype == T.Name & CHROM == 8) %>% arrange(START)
snp_file_MRR_chr8_hap <- snp_file %>% dplyr::filter(chr==8 & pos >= 18168729 & pos <= 18184000)
hapi_file_MRR_chr8_hap <- hapi_file %>% dplyr::filter(chr==8 & start >= 18168729 & end <= 18184000)
hap_file_MRR_chr8_hap <- hap_file %>% dplyr::filter(chr==8 & start >= 18168729 & end <= 18184000)
p <- vis_regional(T.Name, snp_file_MRR_chr8_hap, hapi_file_MRR_chr8_hap, hap_file_MRR_chr8_hap, sig_line=sig_line, ylim = ylim, xtitle = "Chromosome 8")
p1 <- p + geom_segment(data = gene_plot_MRR_region2, aes(x = START, xend = END, y = ylim[2]-1.5, yend = ylim[2]-1.5), lineend = "square", linewidth= 1,alpha = 1,show.legend	=FALSE,color = "blue") +
geom_text(data = gene_plot_MRR_region2, aes(x =START+1000, y = ylim[2]-0.5,label=GENE),color = "blue", size=2.5) +
scale_x_continuous(labels = c("18172000","18180000"),breaks = c(18172000,18180000))
p2 <- p1 + theme(
plot.title = element_blank(),
axis.text.x = element_text(angle = 0, size = 8, vjust = 0.5),
axis.title.x = element_text(size=10),
axis.line.x = element_line(linewidth = 0.8),
axis.ticks.x = element_line(linewidth = 0.8),
axis.line.y = element_blank(),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
png(paste0(output_path_all,T.Name,".F",test,".SNP.HAPI.HAP",other_rules_hap,"_",sig_line,"_regional_chr8.png"), height=400, width=1000,res=300);
print(p2);
dev.off()
load("/Users/zswx/Documents/UCR/Jialab/rice_project/data/Qiong/GBLUP/422geno/reac_norm_samples_123_with_dmt_ow.RData")
