ev<-diag(CLtt)^2
INVtt<-chol2inv(CLtt)
}
DETtt<-prod(ev[ev>0])
logdt2<-log(DETtt)
zm<-xi*zx%*%INVtt
my<-xi*INVtt%*%zy
yHy<-yy-t(zy)%*%my
yHx<-yx-zm%*%zy
xHx<-xx-zm%*%t(zx)
CLxHx<-tryCatch(chol(xHx), error=function(e) NULL)
if (is.null(CLxHx)){
ev<-eigen(xHx)[[1]]
INVxHx<-ginv(xHx)
}
else{
ev<-diag(CLxHx)^2
INVxHx<-chol2inv(CLxHx)
}
DETxHx<-prod(ev[ev>0])
loglike<- -0.5*logdt2-0.5*(n-s)*log(yHy-t(yHx)%*%INVxHx%*%yHx)-0.5*log(DETxHx)
if (!is.finite(loglike)) loglike<--1e+10
return(-loglike)
}
fixed<-function(xi){
tmp0<-zz*xi+diag(r)
CLtmp0<-tryCatch(chol(tmp0), error=function(e) NULL)
if (is.null(CLtmp0)){
INVtmp0<-ginv(tmp0)
}else{
INVtmp0<-chol2inv(CLtmp0)
}
tmp<-xi*INVtmp0
zxm<-zx%*%tmp
zzm<-zz%*%tmp
mzy<-tmp%*%zy
yHy<-yy-t(zy)%*%mzy
yHx<-yx-zx%*%mzy
xHx<-xx-zxm%*%t(zx)
zHx<-zx-zxm%*%zz
zHy<-zy-zzm%*%zy
zHz<-zz-zzm%*%zz
CLxHx<-tryCatch(chol(xHx), error=function(e) NULL)
if (is.null(CLxHx)){
INVxHx<-ginv(xHx)
}else{
INVxHx<-chol2inv(CLxHx)
}
beta<-INVxHx%*%yHx
sigma2<-(yHy-t(yHx)%*%INVxHx%*%yHx)/(n-s)
gamma<-xi*zHy-xi*t(zHx)%*%INVxHx%*%yHx
var<-abs((xi*diag(r)-xi*zHz*xi)*as.numeric(sigma2))
stderr<-var
result<-list(gamma,stderr,beta,sigma2)
return(result)
}
x<-as.matrix(YFIX[,-1])
y<-as.matrix(YFIX[,1])
n<-nrow(y)
s<-ncol(x)
n.var<-length(kin)
lambda<-exp(Theta)
if (n.var>1){
lambda<-as.list(lambda)
Kin<-Map("*", kin, lambda)
KK<-Reduce("+", Kin)
qq<-eigen(KK)
}else{
qq<-eigen(kin[[1]])
qq[[1]]<-lambda*qq[[1]]
}
yu<-t(qq[[2]])%*%y
xu<-t(qq[[2]])%*%x
h<-1/(qq[[1]]+1)
yy<-sum(yu*h*yu)
lx<-t(xu)%*%diag(h)
yx<-lx%*%yu
xx<-lx%*%xu
r<-ncol(z)
zu<-t(qq[[2]])%*%z
lz<-t(zu)%*%diag(h)
zy<-lz%*%yu
zz<-lz%*%zu
zx<-t(lz%*%xu)
Low<-rep(-10,1)
Up<--Low
theta<-rep(0,1)
par<-optim(par=theta,fn=Loglike,hessian = TRUE,method="L-BFGS-B",lower=Low,upper=Up)
xi<-exp(par$par)
conv<-par$convergence
fn1<-par$value
hess<-par$hessian
parmfix<-fixed(xi)
gamma<-parmfix[[1]]
gamma
stderr<-parmfix[[2]]
stderr
1e
1e-3
1e-5
1e-05
dir<-"/Users/zswx/Documents/UCR/Jialab/GWAS2"
setwd(dir)
library(MASS)
library(plyr)
library(dplyr)
library(tidyverse)
#load functions
source("code/GWAS2.fun.R")
dir <- "/bigdata/jialab/shared/QiongJia/GWAS2"
setwd(dir)
function_script<-list.files("GWAS2/R")
function_script_path <- paste0("GWAS2/R/",function_script)
for (i in 1: length(function_script_path)){
source(function_script_path[i])
}
geno_hy_sub <- read_tsv("data/ZhiwuZhang/hybrid_geno_subset.txt",col_names = F)
geno_hy_sub <- geno_hy_sub[1:1000,]
gg <- as.matrix(geno_hy_sub)
View(geno_hy_sub)
freq <- ProF(gg)
View(freq)
keepsnp <- which(freq$maf >=0.05)
print(paste0("The numbers of SNPs with maf >=0.05 is ", length(keepsnp)))
gg_0.05 <- gg[keepsnp,]
View(gg_0.05)
dim(gg_0.05)
function_script<-list.files("GWAS2/R")
function_script_path <- paste0("GWAS2/R/",function_script)
for (i in 1: length(function_script_path)){
source(function_script_path[i])
}
pheno <- read_tsv("data/ZhiwuZhang/Hybrid_phenotype.txt")
T.Name <- "AC"
Trait <- pheno[,which(colnames(pheno)==T.Name)]
na_index <- which(is.na(Trait[,1]))
Trait_noNA <- Trait[-c(na_index),]
test <- (Trait_noNA-mean(Trait_noNA,na.rm = T))/sqrt(var(Trait_noNA,na.rm=T)
)
View(test)
test <- as.numeric(Trait_noNA)
test <- as.matrix(Trait_noNA)
test_scale <- (test-mean(test,na.rm = T))/sqrt(var(test,na.rm=T))
View(test)
mean(test,na.rm = T)
sqrt(var(test,na.rm=T)
)
sqrt(var(test,na.rm=T))
class(sqrt(var(test,na.rm=T)))
as.numeric(sqrt(var(test,na.rm=T)))
test_scale <- (test-mean(test,na.rm = T))/as.numeric(sqrt(var(test,na.rm=T)))
View(test_scale)
plot(density(scale(test_scale)))
shapiro.test(scale(test_scale))
plot(density(log10(Trait_noNA[,1])))
log10(Trait_noNA[,1])
plot(density(as.matrix(log10(Trait_noNA[,1]))))
plot(density(as.matrix(sqrt(Trait_noNA[,1]))))
plot(density(as.matrix(1/Trait_noNA[,1]))
)
test_int <- qnorm((rank(test,na.last="keep")-0.5)/sum(!is.na(test)))
plot(density(test_int))
shapiro.test(test_int)
dim(test_int)
YFIX<-cbind(test_int,rep(1,n))
YFIX<-cbind(as.matrix(test_int),rep(1,n))
YFIX<-cbind(t(test_int),rep(1,n))
class(test_int)
n <- nrow(Trait_noNA)
YFIX<-cbind(t(test_int),rep(1,n))
YFIX<-cbind(test_int,rep(1,n))
View(YFIX)
lrt= 20.6685193674698
p.l<-abs(as.numeric(pchisq(lrt,1,log.p=TRUE)))
p_lrt<-1-pchisq(lrt,1)
install.packages("topr")
dir<-"/Users/zswx/Documents/UCR/Jialab/GWAS2"
setwd(dir)
library(tidyverse)
library(topr)
snp <- read_tsv("data/ZhiwuZhang/PC.FLRT.SNP_map.tsv")
hapi <- read_tsv("data/ZhiwuZhang/PC.FLRT.HAP.Initial_map.tsv")
hap <- read_tsv("data/ZhiwuZhang/PC.FLRT.HAP_map.tsv")
hap <- read_tsv("data/ZhiwuZhang/PC.FLRT.HAP.FINAL_map.tsv")
?manhattan
hap
snp
colnames(snp) <- c("CHROM","POS","P")
colnames(snp) <- c("CHROM","POS","P","ID")
snp
hapi_plot1 <- hapi %>% select(chr, start, p)
hapi_plot2 <- hapi %>% select(chr, end, p)
hapi_plot <- rbind(hapi_plot1,hapi_plot2)
colnames(hapi_plot2) <- c("CHROM","POS","P")
colnames(hapi_plot1) <- c("CHROM","POS","P")
hapi_plot <- rbind(hapi_plot1,hapi_plot2)
hapi_plot <- hapi_plot %>% arrange(CHROM, POS)
View(hapi_plot)
hapi_plot
hap_plot1 <- hap %>% select(chr, start, p)
colnames(hap_plot1) <- c("CHROM","POS","P")
hap_plot2 <- hap %>% select(chr, end, p)
colnames(hap_plot2) <- c("CHROM","POS","P")
hap_plot <- rbind(hap_plot1,hap_plot2)
hap_plot <- hapi_plot %>% arrange(CHROM, POS)
manhattan(list(snp, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-06)
pdf("data/ZhiwuZhang/PC.FLRT.SNP.HAPI.HAP_manhattan.pdf", height=4, width=8);
manhattan(list(snp, hapi_plot,hap_plot), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-06);
dev.off()
dev.off()
?pdf
hapi_plot <- hapi %>% select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot <- hap %>% select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot <- hapi %>% select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hap_plot <- hap %>% select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
dev.off()
pdf("data/ZhiwuZhang/PC.FLRT.SNP.HAPI.HAP_manhattan.pdf", height=4, width=8)
manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("SNP", "di-SNP","Haplotype"),sign_thresh = 5e-06)
dev.off()
png("data/ZhiwuZhang/PC.FLRT.SNP.HAPI.HAP_manhattan.png", height=800, width=1400)
manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = 5e-06)
dev.off()
hap_plot
snp$CHROM <- paste0("chr",snp$CHROM)
snp
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
png("data/ZhiwuZhang/PC.FLRT.SNP.HAPI.HAP_manhattan.png", height=800, width=1400)
manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = 5e-06)
dev.off()
snp %>% group_by(CHROM) %>% summrise(max_POS = max(POS))
library(tidyverse)
snp %>% group_by(CHROM) %>% summrise(max_POS = max(POS))
snp %>% group_by(CHROM) %>% summarize(max_POS = max(POS))
manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = 5e-06, chr="chr12")
dir<-"/Users/zswx/Documents/UCR/Jialab/GWAS2"
setwd(dir)
ibrary(tidyverse)
library(tidyverse)
library(topr)
snp <- read_tsv("data/ZhiwuZhang/PC.FLRT.SNP_map.tsv")
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
hapi <- read_tsv("data/ZhiwuZhang/PC.FLRT.HAP.Initial_map.tsv")
# hapi_plot1 <- hapi %>% select(chr, start, p)
# colnames(hapi_plot1) <- c("CHROM","POS","P")
# hapi_plot2 <- hapi %>% select(chr, end, p)
# colnames(hapi_plot2) <- c("CHROM","POS","P")
# hapi_plot <- rbind(hapi_plot1,hapi_plot2)
# hapi_plot <- hapi_plot %>% arrange(CHROM, POS)
hapi_plot <- hapi %>% select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
hap <- read_tsv("data/ZhiwuZhang/PC.FLRT.HAP.FINAL_map.tsv")
# hap_plot1 <- hap %>% select(chr, start, p)
# colnames(hap_plot1) <- c("CHROM","POS","P")
# hap_plot2 <- hap %>% select(chr, end, p)
# colnames(hap_plot2) <- c("CHROM","POS","P")
# hap_plot <- rbind(hap_plot1,hap_plot2)
# hap_plot <- hap_plot %>% arrange(CHROM, POS)
hap_plot <- hap %>% select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
snp_plot <- as.data.frame(snp)
hapi_plot <- as.data.frame(hapi_plot)
hap_plot <- as.data.frame(hap_plot)
png("data/ZhiwuZhang/PC.FLRT.SNP.HAPI.HAP_manhattan.png", height=800, width=1400)
manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = 5e-06)
dev.off()
png("data/ZhiwuZhang/PC.FLRT.SNP.HAPI.HAP_manhattan.png", height=800, width=1400)
manhattan(list(hap_plot, hapi_plot,snp_plot), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = 5e-06,xmin=1, xmax=12)
dev.off()
manhattan
?get_pos_with_offset4list
get_pos_with_offset4list
??get_pos_with_offset4list
snp <- read_tsv("data/ZhiwuZhang/PC.FLRT.SNP_map.tsv")
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
#snp_plot <- as.data.frame(snp)
hapi <- read_tsv("data/ZhiwuZhang/PC.FLRT.HAP.Initial_map.tsv")
# hapi_plot1 <- hapi %>% select(chr, start, p)
# colnames(hapi_plot1) <- c("CHROM","POS","P")
# hapi_plot2 <- hapi %>% select(chr, end, p)
# colnames(hapi_plot2) <- c("CHROM","POS","P")
# hapi_plot <- rbind(hapi_plot1,hapi_plot2)
# hapi_plot <- hapi_plot %>% arrange(CHROM, POS)
hapi_plot <- hapi %>% select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
#hapi_plot <- as.data.frame(hapi_plot)
hap <- read_tsv("data/ZhiwuZhang/PC.FLRT.HAP.FINAL_map.tsv")
# hap_plot1 <- hap %>% select(chr, start, p)
# colnames(hap_plot1) <- c("CHROM","POS","P")
# hap_plot2 <- hap %>% select(chr, end, p)
# colnames(hap_plot2) <- c("CHROM","POS","P")
# hap_plot <- rbind(hap_plot1,hap_plot2)
# hap_plot <- hap_plot %>% arrange(CHROM, POS)
hap_plot <- hap %>% select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
png("data/ZhiwuZhang/PC.FLRT.SNP.HAPI.HAP_manhattan.png", height=800, width=1400)
manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = 5e-06, build=NULL)
dev.off()
?get_shades
?get_ticks
??get_ticks
png("data/ZhiwuZhang/PC.FLRT.SNP.HAPI.HAP_manhattan_chr12.png", height=800, width=1400)
manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = 5e-06, chr="chr12")
dev.off()
png("data/ZhiwuZhang/PC.FLRT.SNP.HAPI.HAP_manhattan_chr12.png", height=800, width=1400)
manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = 5e-06, chr="chr12",legend_position = "bottom",legend_name = "GWAS Type")
dev.off()
png("data/ZhiwuZhang/PC.FLRT.SNP.HAPI.HAP_manhattan_chr12.png", height=500, width=700)
manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = 5e-06, sign_thresh_label_size = 5,chr="chr12",legend_position = "bottom",legend_name = "GWAS Type")
dev.off()
pdf("data/ZhiwuZhang/PC.FLRT.SNP.HAPI.HAP_manhattan.pdf", height=4, width=8)
manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-06)
dev.off()
snp <- read_tsv("data/ZhiwuZhang/PC.FWALD.SNP_map.tsv")
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
#snp_plot <- as.data.frame(snp)
hapi <- read_tsv("data/ZhiwuZhang/PC.FWALD.HAP.Initial_map.tsv")
hapi_plot <- hapi %>% select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
#hapi_plot <- as.data.frame(hapi_plot)
hap <- read_tsv("data/ZhiwuZhang/PC.FWALD.HAP.FINAL_map.tsv")
hap_plot <- hap %>% select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
#hap_plot <- as.data.frame(hap_plot)
pdf("data/ZhiwuZhang/PC.FWALD.SNP.HAPI.HAP_manhattan.pdf", height=4, width=8)
manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-06)
dev.off()
png("data/ZhiwuZhang/test.png", height=800, width=1400)
manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("pheno1", "pheno2","pheno3"),sign_thresh = 5e-06)
dev.off()
png("data/ZhiwuZhang/test_chr12.png", height=500, width=700)
manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("pheno1", "pheno2","pheno3"),sign_thresh = 5e-06)
dev.off()
png("data/ZhiwuZhang/test_chr12.png", height=500, width=700)
manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("pheno1", "pheno2","pheno3"),sign_thresh = 5e-06, chr="chr12")
dev.off()
dir<-"/Users/zswx/Documents/UCR/Jialab/GWAS2"
#dir <- "/bigdata/jialab/shared/QiongJia/GWAS2"
setwd(dir)
# load packages
library(tidyverse)
library(topr)
snp <- read_tsv("data/ZhiwuZhang/PC.FLRT.SNP_map.tsv")
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
hapi <- read_tsv("data/ZhiwuZhang/PC.FLRT.HAP.Initial_map.tsv")
# hapi_plot1 <- hapi %>% select(chr, start, p)
# colnames(hapi_plot1) <- c("CHROM","POS","P")
# hapi_plot2 <- hapi %>% select(chr, end, p)
# colnames(hapi_plot2) <- c("CHROM","POS","P")
# hapi_plot <- rbind(hapi_plot1,hapi_plot2)
# hapi_plot <- hapi_plot %>% arrange(CHROM, POS)
hapi_plot <- hapi %>% select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
#hapi_plot <- as.data.frame(hapi_plot)
hap <- read_tsv("data/ZhiwuZhang/PC.FLRT.HAP.FINAL_map.tsv")
# hap_plot1 <- hap %>% select(chr, start, p)
# colnames(hap_plot1) <- c("CHROM","POS","P")
# hap_plot2 <- hap %>% select(chr, end, p)
# colnames(hap_plot2) <- c("CHROM","POS","P")
# hap_plot <- rbind(hap_plot1,hap_plot2)
# hap_plot <- hap_plot %>% arrange(CHROM, POS)
hap_plot <- hap %>% select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
png("data/ZhiwuZhang/PC.FLRT.SNP.HAPI.HAP_manhattan_chr12.png", height=500, width=700)
manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = 5e-06, sign_thresh_label_size = 5,chr="chr12",legend_position = "bottom",legend_name = "GWAS Type",use_shades=T)
dev.off()
devtools::install_github("totajuliusd/topr")
install.packages("topr")
version(topr)
help(package="topr")
dir<-"/Users/zswx/Documents/UCR/Jialab/GWAS2"
#dir <- "/bigdata/jialab/shared/QiongJia/GWAS2"
setwd(dir)
setwd(dir)
library(tidyverse)
library(topr)
snp <- read_tsv("data/ZhiwuZhang/PC.FLRT.SNP_map.tsv")
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
hapi <- read_tsv("data/ZhiwuZhang/PC.FLRT.HAP.Initial_map.tsv")
# hapi_plot1 <- hapi %>% select(chr, start, p)
# colnames(hapi_plot1) <- c("CHROM","POS","P")
# hapi_plot2 <- hapi %>% select(chr, end, p)
# colnames(hapi_plot2) <- c("CHROM","POS","P")
# hapi_plot <- rbind(hapi_plot1,hapi_plot2)
# hapi_plot <- hapi_plot %>% arrange(CHROM, POS)
hapi_plot <- hapi %>% select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
#hapi_plot <- as.data.frame(hapi_plot)
hap <- read_tsv("data/ZhiwuZhang/PC.FLRT.HAP.FINAL_map.tsv")
# hap_plot1 <- hap %>% select(chr, start, p)
# colnames(hap_plot1) <- c("CHROM","POS","P")
# hap_plot2 <- hap %>% select(chr, end, p)
# colnames(hap_plot2) <- c("CHROM","POS","P")
# hap_plot <- rbind(hap_plot1,hap_plot2)
# hap_plot <- hap_plot %>% arrange(CHROM, POS)
hap_plot <- hap %>% select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
#hap_plot <- as.data.frame(hap_plot)
pdf("data/ZhiwuZhang/PC.FLRT.SNP.HAPI.HAP_manhattan.pdf", height=4, width=8)
manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
png("data/ZhiwuZhang/PC.FLRT.SNP.HAPI.HAP_manhattan.png", height=500, width=1000)
manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = 5e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
snp <- read_tsv("data/ZhiwuZhang/PC.FWALD.SNP_map.tsv")
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
#snp_plot <- as.data.frame(snp)
hapi <- read_tsv("data/ZhiwuZhang/PC.FWALD.HAP.Initial_map.tsv")
hapi_plot <- hapi %>% select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
#hapi_plot <- as.data.frame(hapi_plot)
hap <- read_tsv("data/ZhiwuZhang/PC.FWALD.HAP.FINAL_map.tsv")
hap_plot <- hap %>% select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
#hap_plot <- as.data.frame(hap_plot)
pdf("data/ZhiwuZhang/PC.FWALD.SNP.HAPI.HAP_manhattan.pdf", height=4, width=8)
manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"), sign_thresh = 5e-06,get_chr_lengths_from_data = T,legend_name = "GWAS Type")
dev.off()
snp <- read_tsv("data/ZhiwuZhang/PC.FLRT.SNP_map.tsv")
colnames(snp) <- c("CHROM","POS","P","ID")
snp$CHROM <- paste0("chr",snp$CHROM)
#snp_plot <- as.data.frame(snp)
hapi <- read_tsv("data/ZhiwuZhang/PC.FLRT.HAP.Initial_map.tsv")
# hapi_plot1 <- hapi %>% select(chr, start, p)
# colnames(hapi_plot1) <- c("CHROM","POS","P")
# hapi_plot2 <- hapi %>% select(chr, end, p)
# colnames(hapi_plot2) <- c("CHROM","POS","P")
# hapi_plot <- rbind(hapi_plot1,hapi_plot2)
# hapi_plot <- hapi_plot %>% arrange(CHROM, POS)
hapi_plot <- hapi %>% select(chr, end, p)
colnames(hapi_plot) <- c("CHROM","POS","P")
hapi_plot$CHROM <- paste0("chr",hapi_plot$CHROM)
#hapi_plot <- as.data.frame(hapi_plot)
hap <- read_tsv("data/ZhiwuZhang/PC.FLRT.HAP.FINAL_map.tsv")
# hap_plot1 <- hap %>% select(chr, start, p)
# colnames(hap_plot1) <- c("CHROM","POS","P")
# hap_plot2 <- hap %>% select(chr, end, p)
# colnames(hap_plot2) <- c("CHROM","POS","P")
# hap_plot <- rbind(hap_plot1,hap_plot2)
# hap_plot <- hap_plot %>% arrange(CHROM, POS)
hap_plot <- hap %>% select(chr, end, p)
colnames(hap_plot) <- c("CHROM","POS","P")
hap_plot$CHROM <- paste0("chr",hap_plot$CHROM)
png("data/ZhiwuZhang/PC.FLRT.SNP.HAPI.HAP_manhattan_chr12.png", height=500, width=700)
manhattan(list(hap_plot, hapi_plot,snp), legend_labels = c("Haplotype", "di-SNP","SNP"),sign_thresh = 5e-06, sign_thresh_label_size = 5,chr="chr12",legend_position = "bottom",legend_name = "GWAS Type")
dev.off()
devtools::install_github("YaoZhou89/BLINK")
source("http://zzlab.net/GAPIT/gapit_functions.txt")
library(BLINK)
myGD=read.big.matrix("myData.dat",head=F,sep="\t",type="char")
myGM=read.table("myData.map",head=T)
library(BLINK)
myGM=read.table("myData.map",head=T)
?myData.map
myGM=read.table("BLINK/data/myData.map",head=T)
myGD=read.big.matrix("BLINK/data/myData.dat",head=F,sep="\t",type="char")
myY = read.table("BLINK/data/myData.txt",head = T)
View(myGD)
class(myGD)
head(myGD)
myY = read.table("BLINK/data/myData.txt",head = T)
head(myY)
View(myGM)
myBlink=Blink(Y=myY,GD=myGD,GM=myGM,maxLoop=10,time.cal=T)
source("http://zzlab.net/GAPIT/gapit_functions.txt")
source("http://zzlab.net/FarmCPU/FarmCPU_functions.txt")
myBlink=Blink(Y=myY,GD=myGD,GM=myGM,maxLoop=10,time.cal=T)
View(myBlink)
head(myBlink[[GWAS]])
?Blink
??Blink
?BLINK::Blink
View(myGD)
myGD[1:10,1:10]
View(myBlink)
View(myBlink)
dir <- "/bigdata/jialab/shared/QiongJia/GWAS2"
setwd(dir)
dir<-"/Users/zswx/Documents/UCR/Jialab/GWAS2"
pheno <- read_tsv("data/ZhiwuZhang/Hybrid_phenotype.txt")
T.Name <- "PC"
Trait <- pheno[,which(colnames(pheno)==T.Name)]
na_index <- which(is.na(Trait[,1]))
Trait_noNA <- Trait[-c(na_index),]
plot(density(Trait_noNA[,1]))
View(Trait_noNA)
shapiro.test(Trait_noNA[,1])
Trait_noNA <- as.matrix(Trait_noNA[,1])
plot(density(Trait_noNA[,1]))
plot(density(as.matrix(log10(Trait_noNA[,1]))))
